<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Atualização Operacional</title>
  <link rel="stylesheet" href="padrao_css_sistema.css">
  <link rel="manifest" href="manifest.json">
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js');
      });
    }
    function ajustarHora() {
      const now = new Date();
      now.setMinutes(0, 0, 0);
      const horaRedonda = now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
      document.getElementById('atualizacao').value = new Date().toLocaleDateString('pt-BR') + ' - ' + horaRedonda;
    }
    function toggleManutencaoFields() {
      const quantidade = parseInt(document.getElementById('veiculos_manutencao').value) || 0;
      const container = document.getElementById('manutencao_container');
      container.innerHTML = '';
      for (let i = 0; i < quantidade; i++) {
        const div = document.createElement('div');
        div.className = 'form-group';
        div.innerHTML = `
          <div class="input-group"><label>Frota</label><input type="text" name="frota_${i}" required></div>
          <div class="input-group"><label>Descrição</label><input type="text" name="descricao_${i}" required></div>
        `;
        container.appendChild(div);
      }
    }
    function enviarParaWhatsApp() {
      let mensagem = '📊 *Atualização Operacional* 📊\n\n';
      mensagem += `*Data/Hora:* ${document.getElementById('atualizacao').value}\n\n`;
      mensagem += `*Projeção de Entrega:* ${document.getElementById('projecao').value} Ton\n`;
      mensagem += `*Entrada de CVs (Usina):* ${document.getElementById('cv_entrada').value}\n`;
      mensagem += `*Saída de CVs (Usina):* ${document.getElementById('cv_saida').value}\n`;
      mensagem += `*Colheita Carregamento Hora:* ${document.getElementById('colheita').value}\n`;
      mensagem += `*Raio Médio:* ${document.getElementById('raio').value} Km\n`;
      mensagem += `*Rotação Média na Usina:* ${document.getElementById('rotacao').value} ${document.getElementById('fracao').value}\n`;
      mensagem += `*Conjuntos Carregados:* ${document.getElementById('conjuntos').value}\n`;
      mensagem += `*Densidade Média:* ${document.getElementById('densidade').value}\n`;
      const qtdManut = parseInt(document.getElementById('veiculos_manutencao').value) || 0;
      mensagem += `*Veículos em Manutenção:* ${qtdManut}\n`;
      for (let i = 0; i < qtdManut; i++) {
        const frota = document.querySelector(`[name='frota_${i}']`).value;
        const descricao = document.querySelector(`[name='descricao_${i}']`).value;
        mensagem += `- Frota: *${frota}* - ${descricao}\n`;
      }
      window.open(`https://wa.me/?text=${encodeURIComponent(mensagem)}`, '_blank');
    }
    window.onload = ajustarHora;
  </script>
</head>
<body>
  <div class="container">
    <div class="header"><h1>📊📊📊📊📊📊📊</h1><p>Atualização Operacional</p></div>
    <div class="content">
      <div class="section">
        <div class="form-group">
          <div class="input-group"><label>Data / Hora</label><input type="text" id="atualizacao" readonly></div>
          <div class="input-group"><label>Projeção de Entrega (Ton) 🚀</label><input type="number" step="0.01" id="projecao"></div>
          <div class="input-group"><label>Entrada de CVs (Usina)</label><input type="number" step="0.01" id="cv_entrada"></div>
          <div class="input-group"><label>Saída de CVs (Usina)</label><input type="number" step="0.01" id="cv_saida"></div>
          <div class="input-group"><label>Colheita Carregamento Hora</label><input type="number" step="0.01" id="colheita"></div>
          <div class="input-group"><label>Raio Médio (Km)</label><input type="number" step="0.01" id="raio"></div>
          <div class="input-group"><label>Rotação Média na Usina</label><input type="number" step="1" id="rotacao">
            <select id="fracao"><option value="">-</option><option value="1/4">1/4</option><option value="1/2">1/2</option><option value="3/4">3/4</option></select>
          </div>
          <div class="input-group"><label>Conjuntos Carregados</label><input type="number" step="0.01" id="conjuntos"></div>
          <div class="input-group"><label>Densidade Média</label><input type="number" step="0.01" id="densidade"></div>
          <div class="input-group"><label>Veículos em Manutenção</label><input type="number" step="1" id="veiculos_manutencao" onchange="toggleManutencaoFields()"></div>
        </div>
        <div id="manutencao_container"></div>
        <div class="text-center mt-3"><button class="btn btn-success" onclick="enviarParaWhatsApp()">Enviar via WhatsApp</button></div>
      </div>
    </div>
    <div class="text-center mt-3 mb-1"><p>Feito com ❤️ por Everton Tezzon Ferreira</p></div>
  </div>
</body>
</html>
