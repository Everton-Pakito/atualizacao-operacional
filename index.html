
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Atualização Operacional</title>
  <link rel="stylesheet" href="padrao_css_sistema.css" />
  <link rel="manifest" href="manifest.json" />
  <script>
    function ajustarHora() {
      const now = new Date();
      now.setMinutes(0, 0, 0);
      const horaRedonda = now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
      document.getElementById('atualizacao').value = new Date().toLocaleDateString('pt-BR') + ' - ' + horaRedonda;
    }

    function calcularColheitaHora() {
      const entrada = parseFloat(document.getElementById('cv_entrada').value);
      const saida = parseFloat(document.getElementById('cv_saida').value);
      const resultado = (!isNaN(entrada) && entrada > 0 && !isNaN(saida)) ? (saida / entrada) : '';
      document.getElementById('colheita').value = resultado ? resultado.toFixed(2) : '';
    }

    function toggleManutencaoFields() {
      const quantidade = parseInt(document.getElementById('veiculos_manutencao').value) || 0;
      const container = document.getElementById('manutencao_container');
      container.innerHTML = '';
      for (let i = 0; i < quantidade; i++) {
        const div = document.createElement('div');
        div.className = 'form-group';
        div.innerHTML = `
          <div class="input-group"><label>Frota</label><input type="text" name="frota_${i}" required></div>
          <div class="input-group"><label>Descrição</label><input type="text" name="descricao_${i}" required></div>
        `;
        container.appendChild(div);
      }
    }

    function enviarParaWhatsApp() {
      let mensagem = '📊 *Atualização Operacional* 📊\n\n';
      mensagem += `*Data/Hora:* *${document.getElementById('atualizacao').value}*\n\n`;
      mensagem += `*Projeção de Entrega:* *${document.getElementById('projecao').value} Ton*\n`;
      mensagem += `*Entrada de CVs (Usina):* *${document.getElementById('cv_entrada').value}*\n`;
      mensagem += `*Saída de CVs (Usina):* *${document.getElementById('cv_saida').value}*\n`;
      mensagem += `*Colheita Carregamento Hora:* *${document.getElementById('colheita').value}*\n`;
      mensagem += `*Raio Médio:* *${document.getElementById('raio').value} Km*\n`;
      mensagem += `*Rotação Média na Usina:* *${document.getElementById('rotacao').value} ${document.getElementById('fracao').value}*\n`;
      mensagem += `*Conjuntos Carregados:* *${document.getElementById('conjuntos').value}*\n`;
      mensagem += `*Densidade Média:* *${document.getElementById('densidade').value}*\n`;
      const qtdManut = parseInt(document.getElementById('veiculos_manutencao').value) || 0;
      mensagem += `*Veículos em Manutenção:* *${qtdManut}*\n`;
      for (let i = 0; i < qtdManut; i++) {
        const frota = document.querySelector(`[name='frota_${i}']`).value;
        const descricao = document.querySelector(`[name='descricao_${i}']`).value;
        mensagem += `- Frota: *${frota}* - *${descricao}*\n`;
      }
      window.open(`https://wa.me/?text=${encodeURIComponent(mensagem)}`, '_blank');
    }

    window.onload = () => {
      ajustarHora();
      document.getElementById('cv_entrada').addEventListener('input', calcularColheitaHora);
      document.getElementById('cv_saida').addEventListener('input', calcularColheitaHora);
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./service-worker.js')
          .then(() => console.log('Service Worker registrado!'));
      }
    };
  </script>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>📊📊📊📊📊📊📊</h1>
    </div>
    <div class="content">
      <!-- Campos do formulário aqui (omitido por brevidade) -->
    </div>
    <div class="footer">Feito com ❤️ por Everton Tezzon Ferreira</div>
  </div>
</body>
</html>
